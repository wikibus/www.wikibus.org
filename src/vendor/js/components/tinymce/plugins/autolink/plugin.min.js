!(function () {
  const e = tinymce.util.Tools.resolve('tinymce.PluginManager'); const i = tinymce.util.Tools.resolve('tinymce.Env'); const m = function (e) { return e.getParam('autolink_pattern', /^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i) }; const y = function (e) { return e.getParam('default_link_target', '') }; const o = function (e, t) { if (t < 0 && (t = 0), e.nodeType === 3) { const n = e.data.length; n < t && (t = n) } return t }; const k = function (e, t, n) { t.nodeType !== 1 || t.hasChildNodes() ? e.setStart(t, o(t, n)) : e.setStartBefore(t) }; const p = function (e, t, n) { t.nodeType !== 1 || t.hasChildNodes() ? e.setEnd(t, o(t, n)) : e.setEndAfter(t) }; const r = function (e, t, n) { let i; let o; let r; let a; let f; let s; let d; let l; let c; let u; const g = m(e); const h = y(e); if (e.selection.getNode().tagName !== 'A') { if ((i = e.selection.getRng(!0).cloneRange()).startOffset < 5) { if (!(l = i.endContainer.previousSibling)) { if (!i.endContainer.firstChild || !i.endContainer.firstChild.nextSibling) return; l = i.endContainer.firstChild.nextSibling } if (c = l.length, k(i, l, c), p(i, l, c), i.endOffset < 5) return; o = i.endOffset, a = l } else { if ((a = i.endContainer).nodeType !== 3 && a.firstChild) { for (;a.nodeType !== 3 && a.firstChild;)a = a.firstChild; a.nodeType === 3 && (k(i, a, 0), p(i, a, a.nodeValue.length)) }o = i.endOffset === 1 ? 2 : i.endOffset - 1 - t } for (r = o; k(i, a, o >= 2 ? o - 2 : 0), p(i, a, o >= 1 ? o - 1 : 0), o -= 1, (u = i.toString()) !== ' ' && u !== '' && u.charCodeAt(0) !== 160 && o - 2 >= 0 && u !== n;);let C; (C = i.toString()) === n || C === ' ' || C.charCodeAt(0) === 160 ? (k(i, a, o), p(i, a, r), o += 1) : (i.startOffset === 0 ? k(i, a, 0) : k(i, a, o), p(i, a, r)), (s = i.toString()).charAt(s.length - 1) === '.' && p(i, a, r - 1), (d = (s = i.toString().trim()).match(g)) && (d[1] === 'www.' ? d[1] = 'http://www.' : /@$/.test(d[1]) && !/^mailto:/.test(d[1]) && (d[1] = `mailto:${d[1]}`), f = e.selection.getBookmark(), e.selection.setRng(i), e.execCommand('createlink', !1, d[1] + d[2]), h && e.dom.setAttrib(e.selection.getNode(), 'target', h), e.selection.moveToBookmark(f), e.nodeChanged()) } }; const t = function (t) { let n; t.on('keydown', (e) => { e.keyCode !== 13 || r(t, -1, '') }), i.ie ? t.on('focus', () => { if (!n) { n = !0; try { t.execCommand('AutoUrlDetect', !1, !0) } catch (e) {} } }) : (t.on('keypress', (e) => { e.keyCode !== 41 || r(t, -1, '(') }), t.on('keyup', (e) => { e.keyCode !== 32 || r(t, 0, '') })) }; e.add('autolink', (e) => { t(e) }), function n() {}
}())
